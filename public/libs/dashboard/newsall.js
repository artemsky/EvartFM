$(function(){"use strict";function t(t){if(t.files&&t.files[0]){var e=new FileReader;e.onload=function(t){$("#preview").attr("src",t.target.result)},e.readAsDataURL(t.files[0])}}var e="/dashboard/news",a=function(t){if(console.log(t),406===t.status){var e="";for(var a in t.responseJSON)e+=t.responseJSON[a]+"\n";alert(e)}else $("body").append(t.responseText)},n=function(t){console.log(t),i.find(".save-changes").addClass("btn-success"),setTimeout(function(){i.find(".save-changes").removeClass("btn-success"),i.modal("hide")},1e3)},i=$("#modal"),s="",r=i.find("form"),o={type:"POST",cache:!1,processData:!1,contentType:!1,headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},success:n,error:a};$("article").on("click",function(){s=r.attr("data-update");var t=$(this);i.find(".modal-title span").text(t.attr("data-id")),i.find("#id").val(t.attr("data-id")),i.find("#long").val(t.find(".title_long").text()),i.find("#short").val(t.find(".title_short").text()),i.find("#article").val(t.find(".article").text()),i.find("#preview").attr("src",t.css("background-image").replace('url("',"").replace('")',"")),i.find(".delete-user").show(),i.find(".save-changes").text("Save changes"),i.modal("show")}),$("#sortby li a").click(function(t){t.preventDefault();var a=location.pathname.split("/");5!==a.length?location.pathname=e+"/"+$(this).attr("href"):location.pathname=e+"/"+$(this).attr("href")+"/"+a[4]}),$("#orderby li a").click(function(t){t.preventDefault();var a=location.pathname.split("/");5!==a.length?location.pathname=e+"/desc/"+$(this).attr("href"):location.pathname=e+"/"+a[3]+"/"+$(this).attr("href")}),$("#image").change(function(){t(this)}),i.find(".save-changes").click(function(t){t.preventDefault(),o.data=new FormData(r.get(0)),$.ajax(s,o)}),$(".new-item").on("click",function(){s=r.attr("data-add"),i.find(".modal-title span").text("New item"),r.get(0).reset(),i.find("#preview").attr("src",""),i.find("#date").get(0).valueAsDate=new Date,i.find(".delete-user").hide(),i.find(".save-changes").text("Add"),i.modal("show")}),$(".delete-item").on("click",function(){var t=i.find("#id").val();$.ajax($(this).attr("data-url"),{type:"DELETE",data:{id:t},headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},success:function(){$('[data-id="'+t+'"]').parent().remove(),i.modal("hide")}})})});