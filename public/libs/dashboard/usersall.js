$(function(){var e=$(".table-striped tbody"),t=$(".modal table tr"),n=$("#edit");n.on("hide.bs.modal",function(){n.find("table p").show(),n.find("table .form-group").hide()});var s=function(e){406===e.status&&console.log(e.responseJSON.Uid)},a=function(e){for(var s in e)t.find(".user_"+s+" p").text(e[s]);n.modal("show"),$(".save-changes").prop("disabled",!0),n.find(".form-group input, select").one("change keypress",function(){$(".save-changes").prop("disabled",!1)})},i="user/edit",r={type:"POST",cache:!1,success:a,error:s,headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}},d=null;e.on("click","tr",function(){d=$(this);var e=parseInt($(this).find("td:first").text());r.success=a,r.error=s,r.data={Uid:e},$.ajax(i,r)}),t.find("td:odd").each(function(e,t){var n=!1;if(!$(t).hasClass("user_id")){if($(t).hasClass("user_password")){var s=$(t).find("input");s.first().on("keypress",function(){s.last().val("")}),n=!0}$(t).on("click","p",function(){var e=$(this),t=$(this).parent().find(".form-group");n||t.find("input").val(e.text()),e.slideUp(),t.slideDown().focus()})}});var o=function(e){406===e.status&&console.log(e);var t=n.find(".modal-header");d.addClass("danger"),t.addClass("btn-danger"),setTimeout(function(){t.removeClass("btn-danger"),d.removeClass("danger success")},3e3)},c=function(e){if(n.modal("hide"),d){d.addClass("success");var t=d.find("td");t.eq(0).text(e.id),t.eq(1).text(e.login),t.eq(2).text(e.role),t.eq(3).text(e.name)}};n.find(".save-changes").click(function(e){e.preventDefault();var t="id="+n.find(".user_id p").text()+"&";r.success=c,r.error=o,r.data=t+n.find("form :input").filter(function(e,t){return $.trim($(t).val()).length>0}).serialize(),console.log(r.data)});var f="user/delete",l=function(){d.remove(),n.modal("hide")};n.find(".delete-user").on("click",function(e){e.preventDefault();var t=n.find(".user_id p").text();r.success=l,r.error=o,r.data={Uid:t},$.ajax(f,r)})});